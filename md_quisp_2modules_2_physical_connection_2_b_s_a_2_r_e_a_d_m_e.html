<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QuISP: Bell State Analyzer</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">QuISP
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md_quisp_2modules_2_physical_connection_2_b_s_a_2_r_e_a_d_m_e.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Bell State Analyzer</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md15"></a></p>
<p>In QuISP, we assume that there is an implicit mechanism for repeaters and end nodes to signal the BSA module about the beginning and the end of the photon trains (e.g., strong light pulse before and after each train). We achieve this in QuISP using the <code>STATIONARY_PULSE_XXX</code> flag where <code>&lt;XXX&gt;</code> can be <code>BEGIN</code>, <code>END</code>, or <code>BOUND</code>. The flag is one of the parameters of the photonic qubit we send to the BSA.</p>
<p>The BSA component in QuISP comprises two modules, the BellStateAnalyzer and the BSAController. BellStateAnalyzer is the physical module where it only concerns itself with measuring the photons coming from the two ports. BSAController on the other hand, handles the messaging and signalling of neighbour QNode(s), sending measurement results and telling them when the first photon should arrive.</p>
<p>The BSA can be inside a QNIC (referred to as QNIC_R or QNIC receiver) which lives inside a QNode, or inside a stand-alone node (BSANode). Its functionality stays the same whether it lives inside a QNIC or a BSANode. The only difference between internal (inside QNode) and external (inside BSANode) is the initialization phase inside the BSAController. The module hierarchy traversal to find the incoming channel and which nodes this BSAController should talk to is different.</p>
<h1><a class="anchor" id="autotoc_md16"></a>
How BellStateAnalyzer Module works</h1>
<p>The BellStateAnalyzer manages its behaviour using a state machine. It has 4 states namely; <code>idle</code>, <code>accepting</code>, <code>accepting_left</code>, and <code>accepting_right</code>. Currently, it caches all the photons coming in from both sides until the last photons from both sides arrive. Then it compiles the results in batches and signals the BSAController which then sends it to QNodes.</p>
<p>In QuISP, we assume that the BSA can distinguish between $\ket{\Psi^+}$ and $\ket{\Psi^-}$ state while it cannot distinguish between $\ket{\Phi^+}$ and $\ket{\Phi^-}$. This leads to a success probability of only 50% even if all the lossy parameters are set to be ideal (no loss, no error, no false positive click).</p>
<p>Pseudocode for BSA:</p>
<p>The parameters </p><div class="fragment"><div class="line">record_left = []</div>
<div class="line">record_right = []</div>
<div class="line">state = <span class="stringliteral">&#39;idle&#39;</span> | <span class="stringliteral">&#39;accepting_left&#39;</span> | <span class="stringliteral">&#39;accepting_right&#39;</span> | <span class="stringliteral">&#39;accepting&#39;</span></div>
<div class="line">indistinguish_time_period = <span class="stringliteral">&#39;positive number in (ns)&#39;</span></div>
<div class="line">dark_count_threshold = <span class="stringliteral">&#39;number in range [0, 1]&#39;</span></div>
<div class="line">efficiency_threshold = <span class="stringliteral">&#39;number in range [0, 1]&#39;</span></div>
<div class="line"><span class="comment"># photon has {from_left, from_right, arrive_time, is_lost, first, last}</span></div>
</div><!-- fragment --><p>State management part </p><div class="fragment"><div class="line"><span class="keyword">def </span>processArrivalPhotons(photon):</div>
<div class="line">    <span class="keywordflow">if</span> (state == <span class="stringliteral">&#39;accepting right&#39;</span> <span class="keywordflow">and</span> photon.from_left) \</div>
<div class="line">        <span class="keywordflow">or</span> (state == <span class="stringliteral">&#39;accepting left&#39;</span> <span class="keywordflow">and</span> photon.from_right) \</div>
<div class="line">        <span class="keywordflow">or</span> (state == <span class="stringliteral">&#39;idle&#39;</span> <span class="keywordflow">and</span> <span class="keywordflow">not</span> photon.first):</div>
<div class="line">        discardPhoton(photon)</div>
<div class="line">        <span class="keywordflow">return</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> state == <span class="stringliteral">&#39;idle&#39;</span>:</div>
<div class="line">        state = <span class="stringliteral">&#39;accepting&#39;</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> photon.from_left:</div>
<div class="line">        record_left.append(photon)</div>
<div class="line">    <span class="keywordflow">else</span>:</div>
<div class="line">        record_right.append(photon)</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> photon.last <span class="keywordflow">and</span> state == <span class="stringliteral">&#39;accepting&#39;</span>:</div>
<div class="line">        <span class="keywordflow">if</span> photon.from_left:</div>
<div class="line">            state = <span class="stringliteral">&#39;accepting right&#39;</span></div>
<div class="line">        <span class="keywordflow">else</span>:</div>
<div class="line">            state = <span class="stringliteral">&#39;accepting left&#39;</span></div>
<div class="line">    <span class="keywordflow">elif</span> photon.last:</div>
<div class="line">        state = <span class="stringliteral">&#39;idle&#39;</span></div>
<div class="line">        processRecords()</div>
</div><!-- fragment --><p>Processing of the cache results </p><div class="fragment"><div class="line"><span class="keyword">def </span>processRecords():</div>
<div class="line">    results_list = []</div>
<div class="line">    <span class="keywordflow">for</span> left_photon, right_photon <span class="keywordflow">in</span> zip(record_left, record_right):</div>
<div class="line">        <span class="keywordflow">if</span> abs(left_photon.arrive_time - right_photon.arrive_time) &lt;= indistinguish_time_period:</div>
<div class="line">            results_list.append(process_indistinguish_photons(left_photon, right_photon))</div>
<div class="line">        <span class="keywordflow">else</span>:</div>
<div class="line">            results_list.append(<span class="stringliteral">&#39;fail&#39;</span>)</div>
</div><!-- fragment --><p>If both the photons should arrive within the indistinguishability time window </p><div class="fragment"><div class="line"><span class="keyword">def </span>process_indistinguish_photons(p, q):</div>
<div class="line">    <span class="keywordflow">if</span> <span class="keywordflow">not</span> p.is_lost <span class="keywordflow">and</span> <span class="keywordflow">not</span> q.is_lost:</div>
<div class="line">        <span class="comment"># perform bell measurement (need 2 rolls because of 2 detectors)</span></div>
<div class="line">        <span class="keywordflow">if</span> (rand() &lt; efficiency_threshold <span class="keywordflow">and</span> rand() &lt; efficiency_threshold):</div>
<div class="line">            <span class="keywordflow">if</span> (rand() &gt; 0.5): <span class="comment"># we get Phi+/- states cannot distinguish</span></div>
<div class="line">                <span class="keywordflow">return</span> <span class="stringliteral">&#39;fail&#39;</span></div>
<div class="line">            <span class="keywordflow">return</span> <span class="stringliteral">&#39;success&#39;</span>, <span class="stringliteral">&#39;Psi+&#39;</span> | <span class="stringliteral">&#39;Psi-&#39;</span> <span class="comment"># select randomly 50:50</span></div>
<div class="line">    <span class="keywordflow">elif</span> (<span class="keywordflow">not</span> p.is_lost <span class="keywordflow">and</span> q.is_lost) <span class="keywordflow">or</span> (p.is_lost <span class="keywordflow">and</span> <span class="keywordflow">not</span> q.is_lost):</div>
<div class="line">        <span class="comment"># WLOG p arrive but q lost</span></div>
<div class="line">        <span class="keywordflow">if</span> p.is_lost: p, q = q, p</div>
<div class="line">        <span class="keywordflow">if</span> (rand() &lt; dark_count_threshold):</div>
<div class="line">            <span class="keywordflow">if</span> (rand() &gt; 0.5): <span class="comment"># we thought we get Phi+/- so we declare fail</span></div>
<div class="line">                <span class="keywordflow">return</span> <span class="stringliteral">&#39;fail&#39;</span></div>
<div class="line">            <span class="keywordflow">return</span> <span class="stringliteral">&#39;success&#39;</span>, <span class="stringliteral">&#39;Psi+&#39;</span> | <span class="stringliteral">&#39;Psi-&#39;</span> <span class="comment"># select randomly 50:50</span></div>
<div class="line">    <span class="keywordflow">else</span>:</div>
<div class="line">        <span class="keywordflow">if</span> (rand() &lt; dark_count_threshold <span class="keywordflow">and</span> rand() &lt; dark_count_threshold):</div>
<div class="line">            <span class="keywordflow">if</span> (rand() &gt; 0.5): <span class="comment"># we thought we get Phi+/- so we declare fail</span></div>
<div class="line">                <span class="keywordflow">return</span> <span class="stringliteral">&#39;fail&#39;</span></div>
<div class="line">            <span class="keywordflow">return</span> <span class="stringliteral">&#39;success&#39;</span>, <span class="stringliteral">&#39;Psi+&#39;</span> | <span class="stringliteral">&#39;Psi-&#39;</span> <span class="comment"># select randomly 50:50</span></div>
<div class="line">    <span class="comment"># measure both in Z basis to simulate loss event</span></div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&#39;fail&#39;</span></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
